name: Build Workflow

on:
	push:

jobs:
	build-windows:
		runs-on: windows-2019
		steps:
			- name: Checkout
			  uses: actions/checkout@v1
			- name: Install Python
			  uses: actions/setup-python@v1
			  with:
				  python-version: '3.9.1'
				  architecture:'x64'
			- name: Install Requirements
			    run: |	
				  pip install requirements.txt
			- name: Run Pyinstaller
			  run:
				  python -m pyinstaller spify.spec
			- uses: actions/upload-artifacts@v2
			  with:
				  name: Windows_spify
				  path: dist/Spify.exe
			- name: Create Release
			  id: create_release
			  uses: actions/create-release@v1
			  env:
				GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
			  with:
				  tag_name: ${{ github.event.head_commit.message }}
			    	release_name: ${{ github.event.head_commit.message }}
			    	overwrite: true
			    	body: |
				  	Test Release v1.0.0
			    	draft: false
			    	prerelease: false
			- name: Upload Release Asset
			  id: upload-release-asset
			  uses: actions/upload-release-asset
			  env:
				GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
			  with:
				  upload_url: ${{steps.create_release.outputs.upload_url}}
			  	asset_path: dist/Spify.exe
				  asset_name: Spify-Windows-amd64.exe
				  asset_content_type: application/zip
